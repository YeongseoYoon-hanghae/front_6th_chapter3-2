# Story 2.3.5.2: ë°˜ë³µ ì¼ì • ë‹¨ì¼ ìˆ˜ì • ì‹œ í¼ ë¡œë”© ë¡œì§ ê°œì„ 

## Status

Ready for Development

## Story

**As a** ìº˜ë¦°ë” ì‚¬ìš©ì,  
**I want** ë°˜ë³µ ì¼ì •ì„ ë‹¨ì¼ ìˆ˜ì •í•  ë•Œ ì›ë³¸ ë°˜ë³µ ì •ë³´ê°€ í¼ì— í‘œì‹œë˜ê¸°ë¥¼,  
**so that** ê¸°ì¡´ ë°˜ë³µ ì„¤ì •ì„ í™•ì¸í•˜ê³  í•„ìš”ì‹œ ìˆ˜ì •í•  ìˆ˜ ìˆë‹¤.

## Problem Statement

í˜„ì¬ "ì´ ì¼ì •ë§Œ ìˆ˜ì •"ì„ ì„ íƒí•˜ë©´:

1. **í¼ ë¡œë”© ì „ì— `convertToSingleEvent` ì‹¤í–‰ë¨** - ë°˜ë³µ ì •ë³´ê°€ ì¦‰ì‹œ ì œê±°ë¨
2. **ë°˜ë³µ ì²´í¬ë°•ìŠ¤ê°€ í•´ì œë¨** - `isRepeating`ì´ falseë¡œ ì„¤ì •ë¨
3. **ë°˜ë³µ ì„¤ì • í•„ë“œë“¤ì´ ìˆ¨ê²¨ì§** - ì‚¬ìš©ìê°€ ì›ë³¸ ì„¤ì •ì„ ë³¼ ìˆ˜ ì—†ìŒ

## Acceptance Criteria

1. **ì›ë³¸ ë°ì´í„° ë¡œë”©** - ë‹¨ì¼ ìˆ˜ì • ì‹œ `convertToSingleEvent` í˜¸ì¶œí•˜ì§€ ì•ŠìŒ
2. **ë°˜ë³µ ì •ë³´ í‘œì‹œ** - í¼ì—ì„œ ì›ë³¸ ë°˜ë³µ ì„¤ì •ì´ ì •í™•í•˜ê²Œ í‘œì‹œë¨
3. **ì²´í¬ë°•ìŠ¤ í™œì„±í™”** - ë°˜ë³µ ì¼ì • ì²´í¬ë°•ìŠ¤ê°€ ì²´í¬ëœ ìƒíƒœë¡œ í‘œì‹œë¨
4. **í•„ë“œ í‘œì‹œ** - ë°˜ë³µ ìœ í˜•, ê°„ê²©, ì¢…ë£Œì¼ í•„ë“œê°€ ëª¨ë‘ ë³´ì„
5. **ë‹¨ì¼ ìˆ˜ì • í”Œë˜ê·¸ ì„¤ì •** - `startSingleEdit` í•¨ìˆ˜ í˜¸ì¶œë¡œ ëª¨ë“œ êµ¬ë¶„

## Technical Solution

### 1. App.tsxì˜ handleEditRecurringEvent ìˆ˜ì •

```typescript
// src/App.tsx - í˜„ì¬ êµ¬í˜„
const handleEditRecurringEvent = (event: Event) => {
  if (event.repeat.type !== 'none') {
    overlay.open(({ isOpen, close }) => (
      <RecurringEditDialog
        isOpen={isOpen}
        targetEvent={event}
        onCancel={close}
        onEditSingle={() => {
          close();
          // ğŸ”¥ ë¬¸ì œ: convertToSingleEventë¡œ ë°˜ë³µ ì •ë³´ ì œê±°
          editEvent(convertToSingleEvent(event));
        }}
      />
    ));
  } else {
    editEvent(event);
  }
};
```

```typescript
// src/App.tsx - ìˆ˜ì •ëœ êµ¬í˜„
const handleEditRecurringEvent = (event: Event) => {
  if (event.repeat.type !== 'none') {
    overlay.open(({ isOpen, close }) => (
      <RecurringEditDialog
        isOpen={isOpen}
        targetEvent={event}
        onCancel={close}
        onEditSingle={() => {
          close();
          // âœ… ê°œì„ : ì›ë³¸ ë°ì´í„°ë¡œ ë‹¨ì¼ ìˆ˜ì • ëª¨ë“œ ì‹œì‘
          startSingleEdit(event);
        }}
      />
    ));
  } else {
    editEvent(event);
  }
};
```

### 2. í¸ì§‘ ìƒíƒœ í›… í†µí•©

```typescript
// src/App.tsx - useEditingState í›… ì‚¬ìš©
const { editingEvent, isEditing, isSingleEdit, startEdit, startSingleEdit, stopEditing } =
  useEditingState();

// editEvent í•¨ìˆ˜ë¥¼ startEditë¡œ ëŒ€ì²´
const editEvent = (event: Event) => startEdit(event);
```

### 3. í¼ ìƒíƒœ ì´ˆê¸°í™” ë¡œì§ í™•ì¸

```typescript
// src/hooks/useFormState.ts - í˜„ì¬ ë¡œì§ ìœ ì§€
const getInitialFormState = (initialEvent?: Event): FormState => ({
  // ...
  isRepeating: initialEvent ? initialEvent.repeat.type !== 'none' : false,
  // ì›ë³¸ ì´ë²¤íŠ¸ê°€ ë°˜ë³µ ì¼ì •ì´ë©´ isRepeatingì´ trueê°€ ë¨
});
```

## Implementation Tasks

- [ ] **handleEditRecurringEvent í•¨ìˆ˜ ìˆ˜ì •**

  - [ ] `convertToSingleEvent` í˜¸ì¶œ ì œê±°
  - [ ] `startSingleEdit` í•¨ìˆ˜ í˜¸ì¶œë¡œ ë³€ê²½
  - [ ] ê¸°ì¡´ `editEvent` í˜¸ì¶œê³¼ ë™ì¼í•œ ê²°ê³¼ ë³´ì¥

- [ ] **í¸ì§‘ ìƒíƒœ í›… í†µí•©**

  - [ ] `useEditingState` í›… import ë° ì‚¬ìš©
  - [ ] ê¸°ì¡´ í¸ì§‘ ê´€ë ¨ ë¡œì»¬ ìƒíƒœ ì œê±°
  - [ ] `editEvent` í•¨ìˆ˜ë¥¼ `startEdit`ë¡œ í†µí•©

- [ ] **ë™ì‘ ê²€ì¦**
  - [ ] ë°˜ë³µ ì¼ì • ë‹¨ì¼ ìˆ˜ì • ì‹œ í¼ì— ì›ë³¸ ë°ì´í„° í‘œì‹œ í™•ì¸
  - [ ] ì¼ë°˜ í¸ì§‘ ëª¨ë“œ ì •ìƒ ë™ì‘ í™•ì¸
  - [ ] í¸ì§‘ ì·¨ì†Œ ì‹œ ìƒíƒœ ì •ë¦¬ í™•ì¸

## Test Cases

### Test 1: ë°˜ë³µ ì¼ì • ë‹¨ì¼ ìˆ˜ì • ì‹œ ì›ë³¸ ë°ì´í„° ë¡œë”©

```typescript
test('ë°˜ë³µ ì¼ì • ë‹¨ì¼ ìˆ˜ì • ì‹œ ì›ë³¸ ë°˜ë³µ ì •ë³´ê°€ í¼ì— í‘œì‹œë¨', async () => {
  const recurringEvent = {
    id: '1',
    title: 'íŒ€ íšŒì˜',
    repeat: { type: 'weekly', interval: 1, endDate: '2024-12-31' },
  };

  render(<App />);

  // ë°˜ë³µ ì¼ì • í´ë¦­
  const eventElement = screen.getByText('íŒ€ íšŒì˜');
  fireEvent.click(eventElement);

  // "ì´ ì¼ì •ë§Œ ìˆ˜ì •" ì„ íƒ
  const editSingleButton = screen.getByText('ì´ ì¼ì •ë§Œ ìˆ˜ì •');
  fireEvent.click(editSingleButton);

  // í¼ì—ì„œ ë°˜ë³µ ì •ë³´ í™•ì¸
  expect(screen.getByLabelText('ë°˜ë³µ ì¼ì •')).toBeChecked();
  expect(screen.getByDisplayValue('ë§¤ì£¼')).toBeInTheDocument();
  expect(screen.getByDisplayValue('1')).toBeInTheDocument();
});
```

### Test 2: ì¼ë°˜ í¸ì§‘ ëª¨ë“œ ì •ìƒ ë™ì‘

```typescript
test('ì¼ë°˜ ì¼ì • í¸ì§‘ì€ ê¸°ì¡´ê³¼ ë™ì¼í•˜ê²Œ ë™ì‘í•¨', async () => {
  const singleEvent = {
    id: '1',
    title: 'ê°œì¸ ì•½ì†',
    repeat: { type: 'none' },
  };

  render(<App />);

  const eventElement = screen.getByText('ê°œì¸ ì•½ì†');
  fireEvent.click(eventElement);

  // ë°”ë¡œ í¸ì§‘ í¼ì´ ì—´ë¦¼ (ë‹¤ì´ì–¼ë¡œê·¸ ì—†ìŒ)
  expect(screen.getByLabelText('ì œëª©')).toBeInTheDocument();
  expect(screen.queryByText('ì´ ì¼ì •ë§Œ ìˆ˜ì •')).not.toBeInTheDocument();
});
```

### Test 3: ë‹¨ì¼ ìˆ˜ì • í”Œë˜ê·¸ ì„¤ì •

```typescript
test('ë‹¨ì¼ ìˆ˜ì • ëª¨ë“œì—ì„œ isSingleEdit í”Œë˜ê·¸ê°€ trueë¡œ ì„¤ì •ë¨', async () => {
  const { result } = renderHook(() => useEditingState());

  const recurringEvent = {
    id: '1',
    repeat: { type: 'weekly' },
  };

  act(() => {
    result.current.startSingleEdit(recurringEvent);
  });

  expect(result.current.isSingleEdit).toBe(true);
  expect(result.current.editingEvent).toBe(recurringEvent);
});
```

## Definition of Done

- [ ] `handleEditRecurringEvent`ì—ì„œ `convertToSingleEvent` í˜¸ì¶œ ì œê±°ë¨
- [ ] ë‹¨ì¼ ìˆ˜ì • ì‹œ `startSingleEdit` í•¨ìˆ˜ í˜¸ì¶œë¨
- [ ] ë°˜ë³µ ì¼ì • ë‹¨ì¼ ìˆ˜ì • ì‹œ í¼ì— ì›ë³¸ ì •ë³´ í‘œì‹œë¨
- [ ] ëª¨ë“  ë‹¨ìœ„ í…ŒìŠ¤íŠ¸ í†µê³¼
- [ ] ì¼ë°˜ í¸ì§‘ ëª¨ë“œ ì •ìƒ ë™ì‘ í™•ì¸
- [ ] ì½”ë“œ ë¦¬ë·° ì™„ë£Œ

## Dependencies

**ì „ì œ ì¡°ê±´:**

- Story 2.3.5.1 (ë‹¨ì¼ ìˆ˜ì • ëª¨ë“œ ìƒíƒœ ê´€ë¦¬ ê°œì„ ) ì™„ë£Œ
- ê¸°ì¡´ `RecurringEditDialog` ì»´í¬ë„ŒíŠ¸ êµ¬í˜„ ì™„ë£Œ

**ë‹¤ìŒ ìŠ¤í† ë¦¬:**

- Story 2.3.5.3 (ì œì¶œ ë¡œì§ ê°œì„ ) - ì œì¶œ ì‹œì ì— ë‹¨ì¼ ì „í™˜ ì²˜ë¦¬

## Estimated Effort

**ê°œë°œ ì‹œê°„:** 2-3ì‹œê°„  
**í…ŒìŠ¤íŠ¸ ì‹œê°„:** 2ì‹œê°„  
**ì´ ì˜ˆìƒ ì‹œê°„:** 4-5ì‹œê°„

## Notes

ì´ ìŠ¤í† ë¦¬ëŠ” ì‚¬ìš©ìê°€ ë°˜ë³µ ì¼ì •ì˜ ì›ë³¸ ì„¤ì •ì„ í™•ì¸í•  ìˆ˜ ìˆê²Œ í•´ì£¼ëŠ” í•µì‹¬ ê¸°ëŠ¥ì…ë‹ˆë‹¤. í¼ ë¡œë”© ì‹œì ê³¼ ì œì¶œ ì‹œì ì„ ë¶„ë¦¬í•˜ì—¬ ë” ë‚˜ì€ ì‚¬ìš©ì ê²½í—˜ì„ ì œê³µí•©ë‹ˆë‹¤.
